# Laboratorio 03-E: "Microservicios"
 
# Este laboratorio crearemos una aplicación el lenguaje Go. Esta app 
# la compilaremos en el mismo momento de generar la imagen de contenedor.
#
# La app levanta un servidor web que, si nos conectamos, nos responde indicando
# el nombre del host y las direcciones IPs que tiene asignada. 
#
# Posteriormente crearemos un servicio en Swarm para demostrar en balanceo.

# Requisitos:
#   Una máquina virtual con Ubuntu 20.04 LTS a la que poder hacer ssh.
#   Tener instalado Docker-ce en dicha máquina virtual.

##################################
# Ejercicio 1: Instalación de Go #
##################################

# Nos ponemos en HOME.

cd ~


# Descargamos el compilador de Go, lo descoprimimos, cambiamos propietario y lo movemos de carpeta

curl -O https://dl.google.com/go/go1.15.5.linux-amd64.tar.gz

tar xvf go1.15.5.linux-amd64.tar.gz

sudo chown -R root:root ./go

sudo mv go /usr/local


# Editamos '.profile' para agregar variables en entorno al final del archivo.

code .profile

# Agregar estas dos líneas al final del archivo:
# (OJO, retirar los caracteres '#')

# export GOPATH=$HOME/k8s_desarrolladores/03/work
# export PATH=$PATH:/usr/local/go/bin:$GOPATH/bin

# Guardar y salir.


# Cargamos el profile para que se actualicen las varibles de entorno.

source .profile


# Editamos el archivo 'hello.go' que usaremos para probar el compilador.

code ~/k8s_desarrolladores/03/work/src/hello/hello.go


# Como se puede comprobar es un código sencillo que muestra el mensaje 'Hola Mundo!!!'

# Procedemos a compilarlo, indicando el nombre de la carpeta. Se procederá a compilar todos los
# archivos .go que existan (solo está 'hello.go')

go install hello


# Comprobamos si ha compilado escribiendo el nombre del ejecutable ('hello')

hello


# Para determinar la carpeta en la que Go coloca el ejecutable:

which hello


# Acabamos de comprobar que el compilador de Go funciona. Procedemos a crear una app que 
# haga algo más apropiado. Se encuentra en el archivo 
# '~/k8s_desarrolladores/03/work/src/hellocontainer/helloContainer.go'
#
# La editamos.

code ~/k8s_desarrolladores/03/work/src/hellocontainer/helloContainer.go


